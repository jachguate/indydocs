<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdMessage.LoadFromFile Method</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdMessage_LoadFromFile@string@Boolean.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdMessage.html" target="topic">TIdMessage Class</a> &gt; <a href="!!MEMBERTYPE_Methods_TIdMessage.html" target="topic">TIdMessage Methods</a> &gt; <a href="TIdMessage_LoadFromFile@string@Boolean.html" target="topic">LoadFromFile Method</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdMessage_IsBodyEncodingRequired.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><a href="!!MEMBERTYPE_Methods_TIdMessage.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_up_midblue.gif');"></a><a href="TIdMessage_LoadFromStream@TIdStream@Boolean.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdMessage.LoadFromFile Method</div>
<div class="Element7">
<a href="TIdMessage.html" target="topic">TIdMessage Class</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdMessage.html" target="topic">TIdMessage Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Pascal,Parameters,Description,Exceptions,Example,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Pascal,Parameters,Description,Exceptions,Example,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Loads message headers and message parts from a file.</p></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100"><strong>procedure</strong> LoadFromFile(
    <strong>const</strong> AFileName: <strong>string</strong>; 
    <strong>const</strong> AHeadersOnly: Boolean = False
);</pre></div></div>
</div>
<a name="Parameters"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Parameters');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgParameters">Parameters</a></div>
<div id="divParameters">
<div class="Element11">
<div class="Element10">
<div class="Element252">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element240" valign="top" width="35%">
<div class="Element241">
Parameters&nbsp;</div></td><td class="Element244" valign="top" width="65%">
<div class="Element245">
Description&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AFileName&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
File containing values to load into the message.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AHeadersOnly&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Indicates if only headers for the message should be loaded from the file. Default value is False.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
LoadFromFile is a procedure that loads the headers and optional contents for a message from the file name specified in AFilename. If AFilename is not a valid file name on the the local file system, an <a href="EIdMessageCannotLoad.html" target="topic">EIdMessageCannotLoad</a> exception will be raised and the method will be aborted.&nbsp;</p>
<p class="Element10">
Existing content in the <a href="TIdMessage.html" target="topic">TIdMessage</a> instance is cleared prior to loading the values found in the specified file name.&nbsp;</p>
<p class="Element10">
LoadFromFile creates an instance of TFileStream to be used to reading the values for the message instance. The file stream is created using the file mode constants that allow shared read with denied write priviliges (<a href="FileOpenShareModeConstants.html" target="topic">fmOpenRead</a> <a href="FileOpenShareModeConstants.html" target="topic">fmShareDenyWrite</a>). LoadFromFile calls <a href="TIdMessage_LoadFromStream@TIdStream@Boolean.html" target="topic">LoadFromStream</a> using the file stream to perform the physical input operation. The TFileStream instance is freed prior to exiting from the method.&nbsp;</p>
<p class="Element10">
When AHeadersOnly is True, only header values up to and including the blank line delimiter in RFC message headers will be read from the input file. When AHeadersOnly is False, both message <a href="TIdMessage_Headers.html" target="topic">Headers</a> and <a href="TIdMessage_MessageParts.html" target="topic">MessageParts</a> will be read and stored in the message instance.&nbsp;</p>
<p class="Element10">
Use <a href="TIdMessage_SaveToFile@string@Boolean.html" target="topic">SaveToFile</a> to <a href="TIdBaseComponent_Create@TComponent.html" target="topic">create</a> a file suitable for use with LoadFromFile. Use LoadFromSteam to read message contents from a TStream descendant. Use <a href="TIdMessage_SaveToStream@TIdStream@Boolean.html" target="topic">SaveToStream</a> to populate a stream with values suitable for use with LoadFromSteam.&nbsp;</p>
<p class="Element10">
Both LoadFromFile and <a href="TIdMessage_LoadFromStream@TIdStream@Boolean.html" target="topic">LoadFromStream</a> are designed to handle messages written using the <a href="TIdMessage_SaveToStream@TIdStream@Boolean.html" target="topic">SaveToStream</a> or SavedToFile methods in the Indy <a href="TIdMessage.html" target="topic">TIdMessage</a> component. These methods <a href="TIdBaseComponent_Create@TComponent.html" target="topic">create</a> an encoded version of the message contents that matches the protocol tranmissions used when the message is transmitted using <a href="TIdSMTP.html" target="topic">TIdSMTP</a> including the message terminator characters (CRLF.CRLF). If you are trying to import .EML message files from MS Outlook Express, or another email client, make sure that the text file contains the message terminator sequence. An exception will be raised if LoadFromFile or <a href="TIdMessage_LoadFromStream@TIdStream@Boolean.html" target="topic">LoadFromStream</a> are used to load files that do not include the message terminator sequence.&nbsp;</p>
<p class="Element10">
Please not that <a href="TIdMessage.html" target="topic">TIdMessage</a> has no pre-defined mechanism that determines paths or file names used for local storage of message instances. That is an implementation detail specific to the mail or news client constructed using the Indy components.</p></div>
</div>
</div>
<a name="Exceptions"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Exceptions');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgExceptions">Exceptions</a></div>
<div id="divExceptions">
<div class="Element11">
<div class="Element10">
<div class="Element312">
<div class="TableDiv">
<table cellspacing="0" class="Table3">
<tr>
<td class="Element300" valign="top" width="35%">
<div class="Element301">
Exceptions&nbsp;</div></td><td class="Element304" valign="top" width="65%">
<div class="Element305">
Description&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
<a href="EIdMessageCannotLoad.html" target="topic">EIdMessageCannotLoad</a>&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
Raised with the message <a href="RSIdMessageCannotLoad.html" target="topic">RSIdMessageCannotLoad</a> when the specified file name does not exist.<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
<a href="EIdException.html" target="topic">EIdException</a>&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
Raised with the message <a href="RSMsgClientUnkownMessagePartType.html" target="topic">RSMsgClientUnkownMessagePartType</a> when an unknown message part type is encountered when processing the body of a message part.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="Example"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Example');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgExample">Example</a></div>
<div id="divExample">
<div class="Element11">
<div class="Element10">
<p class="Element10">
[Delphi] Loading a message instance from a disk file.&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00039');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00039"><pre class="Element12">  <i>// var Msg: TIdMessage;</i>
  <i>// Msg := TIdMessage.Create(Nil);</i>

  <i>// load headers only</i>
  Msg.LoadFromFile(sStorePath + sFilename, True);

  <i>// load complete message including message parts</i>
  Msg.LoadFromFile(sStorePath + sFilename, False);

  <i>// Msg.Free;</i></pre></div></div>
</div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
<a href="TIdMessage_LoadFromStream@TIdStream@Boolean.html" target="topic">TIdMessage.LoadFromStream</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdMessage_SaveToFile@string@Boolean.html" target="topic">TIdMessage.SaveToFile</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdMessage_SaveToStream@TIdStream@Boolean.html" target="topic">TIdMessage.SaveToStream</a>&nbsp;</p>
<p class="Section9">
 <a href="EIdMessageCannotLoad.html" target="topic">EIdMessageCannotLoad</a></p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="TIdMessage.html" target="topic">TIdMessage Class</a><br /><a href="!!MEMBEROVERVIEW_TIdMessage.html" target="topic">TIdMessage Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>