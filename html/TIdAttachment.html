<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdAttachment Class</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdAttachment.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdAttachment.html" target="topic">TIdAttachment Class</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdAS400FTPListItem.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><img src="btn_up_d.gif" border="0" alt="Up" title="Up"><a href="!!MEMBEROVERVIEW_TIdAttachment.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdAttachment Class</div>
<div class="Element7">
<a href="!!MEMBERTYPE_Methods_TIdAttachment.html" target="topic">TIdAttachment Methods</a> &nbsp; <a href="!!MEMBERTYPE_Properties_TIdAttachment.html" target="topic">TIdAttachment Properties</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdAttachment.html" target="topic">TIdAttachment Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Hierarchy,Pascal,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Hierarchy,Pascal,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Encapsulates a MIME-encoded attachment or inline graphic.</p></div>
</div>
<a name="File"></a><div class="Element14">
File</div>
<div class="Element10033">
<div class="Section33">
<p class="Section33">
<a href="IdAttachment_pas.html" target="topic">IdAttachment</a></p></div>
</div>
<a name="Hierarchy"></a><div class="Section1000032">
<a onclick="toggleVisibilityStored('Hierarchy');" class="a_Section1000032"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgHierarchy">Hierarchy</a></div>
<div id="divHierarchy">
<div class="Element151"><div class="Element150"><pre class="Element150"><img src="TIdAttachment.png" border="0" alt="" title="" usemap="#TIdAttachment"><map class="Element150" name="TIdAttachment"><area class="Element150" shape="rect" coords="123,0,209,15" href="TIdMessagePart.html"><area class="Element150" shape="rect" coords="239,0,320,15" href="TIdAttachment.html"></map></pre></div></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100">TIdAttachment = <strong>class</strong>(TIdMessagePart);</pre></div></div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
TIdAttachment is a <a href="TIdMessagePart.html" target="topic">TIdMessagePart</a> descendant that encapsulates a MIME-encoded attachment or inline graphic. TIdAttachment, <a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile</a>, <a href="TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory</a>, and <a href="TIdText.html" target="topic">TIdText</a> are used as collection items in the <a href="TIdMessageParts.html" target="topic">TIdMessageParts</a> collection.&nbsp;</p>
<p class="Element10">
TIdAttachment publishes properties that provide read and write access to additional header values common to mail message attachments.&nbsp;</p>
<p class="Element10">
TIdAttachment specifies abstract virtual methods that allow the Internet Message attachment to retrieve and store the contents of its headers and message body using a stream.&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element15">
Sending a Message with Attachments</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
For sending a message with attachments, the following abstract virtual methods need to be overridden and reimplemented:&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601"><a href="TIdMessagePart_Create@TIdCollection.html" target="topic">Create</a></li>
<li class="Element601"><a href="TIdAttachment_OpenLoadStream.html" target="topic">OpenLoadStream</a></li>
<li class="Element601"><a href="TIdAttachment_CloseLoadStream.html" target="topic">CloseLoadStream</a></li>
</ul>&nbsp;</p>
<p class="Element10">
<a href="TIdMessagePart_Create@TIdCollection.html" target="topic">Create</a> accepts an argument that indicates the file, string, or stream containing the contents of the attachment. TIdAttachment does not implement a constructor for the class that allows specifying the file, string, stream with the contents of the attachment.&nbsp;</p>
<p class="Element10">
When a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance is transmitted using <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a>, or a descendant class, the overridden <a href="TIdAttachment_OpenLoadStream.html" target="topic">OpenLoadStream</a> and <a href="TIdAttachment_CloseLoadStream.html" target="topic">CloseLoadStream</a> in an attachment are called. These overridden methods open and close the internal stream used for loading the contents of the message part during transmission.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachment_OpenLoadStream.html" target="topic">OpenLoadStream</a> accesses (or creates) a stream used for loading the contents of the message part. During transmission, values in the internal stream are encoded based on the properties specified in the message or message part in <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a> methods like SendHeader and SendBody.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachment_CloseLoadStream.html" target="topic">CloseLoadStream</a> ensures that the internal stream for accessing data in the message part is reset when all values have been read during transmission. If the internal stream is created in <a href="TIdAttachment_OpenLoadStream.html" target="topic">OpenLoadStream</a>, it is freed in <a href="TIdAttachment_CloseLoadStream.html" target="topic">CloseLoadStream</a>. An existing stream is repositioned to its initial position prior to reading values for the message part.&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element15">
Accessing or Receiving a message with Attachments</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
When loading or receiving a message with attachments, the following abstract virtual methods need to be overridden and reimplemented:&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601"><a href="TIdAttachment_PrepareTempStream.html" target="topic">PrepareTempStream</a></li>
<li class="Element601"><a href="TIdAttachment_FinishTempStream.html" target="topic">FinishTempStream</a></li>
</ul>&nbsp;</p>
<p class="Element10">
When a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance is received and processed using <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a>, or a descendant class, the overridden <a href="TIdAttachment_PrepareTempStream.html" target="topic">PrepareTempStream</a> and <a href="TIdAttachment_FinishTempStream.html" target="topic">FinishTempStream</a> methods for the attachment are called. These methods apply to both receiving a message from a remote mail server or accessing a message from a local mail store. Essentially, the actions are the same - differing only in the type of stream used to read the message contents.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachment_PrepareTempStream.html" target="topic">PrepareTempStream</a> ensures that the temporary stream used for processing the contents of the message part are allocated, sized, and/or positioned prior to reading values to be stored in a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachment_FinishTempStream.html" target="topic">FinishTempStream</a> ensures that the temporary stream used for processing the contents of the message part are freed, and/or repositioned after reading values stored in a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance.&nbsp;</p>
<p class="Element10">
The ProcessMessage, ReceiveHeader, and ReceiveBody methods in <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a> rely on the overridden methods.&nbsp;</p>
<p class="Element10">
Applications do not normally <a href="TIdMessagePart_Create@TIdCollection.html" target="topic">create</a> instances of TIdAttachment. Use <a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile</a> or <a href="TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory</a>, which implement the abstract virtual methods required to <a href="TIdMessagePart_Create@TIdCollection.html" target="topic">create</a>, load, or save the attachment using the desired string, stream, or file.</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
<a href="TIdMessage_MessageParts.html" target="topic">TIdMessage.MessageParts</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdMessagePart.html" target="topic">TIdMessagePart</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdText.html" target="topic">TIdText</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory</a>&nbsp;</p>
<p class="Section9">
 <a href="IndySupport.html" target="topic">IndySupport</a></p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="!!MEMBERTYPE_Methods_TIdAttachment.html" target="topic">TIdAttachment Methods</a><br /><a href="!!MEMBERTYPE_Properties_TIdAttachment.html" target="topic">TIdAttachment Properties</a><br /><a href="!!MEMBEROVERVIEW_TIdAttachment.html" target="topic">TIdAttachment Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>