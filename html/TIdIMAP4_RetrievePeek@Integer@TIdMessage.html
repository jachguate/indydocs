<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdIMAP4.RetrievePeek Method</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdIMAP4_RetrievePeek@Integer@TIdMessage.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a> &gt; <a href="!!MEMBERTYPE_Methods_TIdIMAP4.html" target="topic">TIdIMAP4 Methods</a> &gt; <a href="TIdIMAP4_RetrievePeek@Integer@TIdMessage.html" target="topic">RetrievePeek Method</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdIMAP4_RetrievePartToFilePeek@Integer@string@Integer@string@string.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><a href="!!MEMBERTYPE_Methods_TIdIMAP4.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_up_midblue.gif');"></a><a href="!!OVERLOADED_RetrieveStructure_TIdIMAP4.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdIMAP4.RetrievePeek Method</div>
<div class="Element7">
<a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdIMAP4.html" target="topic">TIdIMAP4 Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Pascal,Parameters,Returns,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Pascal,Parameters,Returns,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Retrieves a message from a mailbox without marking it as read on the server.</p></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100"><strong>function</strong> RetrievePeek(
    <strong>const</strong> AMsgNum: Integer; 
    AMsg: TIdMessage
): Boolean;</pre></div></div>
</div>
<a name="Parameters"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Parameters');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgParameters">Parameters</a></div>
<div id="divParameters">
<div class="Element11">
<div class="Element10">
<div class="Element252">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element240" valign="top" width="35%">
<div class="Element241">
Parameters&nbsp;</div></td><td class="Element244" valign="top" width="65%">
<div class="Element245">
Description&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AMsgNum&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Message number to retreive from the mailbox.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AMsg&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Stores the retrieved message headers, body, and attachments.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="Returns"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Returns');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgReturns">Returns</a></div>
<div id="divReturns">
<div class="Element11">
<div class="Element10">
<p class="Element10">
Boolean - True on success.</p></div>
</div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
RetrievePeek is a Boolean function that retrieves the entire contents for a message from a mailbox without marking it as read on the remote IMAP4 server.&nbsp;</p>
<p class="Element10">
Please note that &quot;Peek&quot; versions of the IMAP4 functions do <strong>NOT</strong> set the mfSeen message flag. A new message in your inbox should not have set the mfSeen flag until you <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> the message via a function such as <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">Retrieve</a>. You can, however, <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> the message via RetrievePeek, which should not set the mfSeen flag. The situation is not so clear, however, if you <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> the third attachment (only) of an email. All the &quot;Peek&quot; versions of <a href="TIdIMAP4.html" target="topic">TIdIMAP4</a> functions do imply that the mfSeen flag NOT be set. Be aware that IMAP4 server support for the &quot;Peek&quot; functionality may vary.&nbsp;</p>
<p class="Element10">
RetrievePeek requires that <a href="TIdIMAP4_ConnectionState.html" target="topic">ConnectionState</a> contain the value csSelected, or an <a href="EIdConnectionStateError.html" target="topic">EIdConnectionStateError</a> exception will be raised.&nbsp;</p>
<p class="Element10">
RetrievePeek calls a protected method that sends the IMAP4 FETCH command for the message number specified in AMsgNum. RetrievePeek performs validation for the relative message number to ensure that it contains a positive non-zero value. An <a href="EIdNumberInvalid.html" target="topic">EIdNumberInvalid</a> exception can be raised if the relative message number in aMsgNum is invalid.&nbsp;</p>
<p class="Element10">
On successful retrieval of the RFC 822 envelope data, RetrievePeek calls ReceiveHeader and ReceiveBody to load the message contents into the <a href="TIdMessage.html" target="topic">TIdMessage</a> instance specified by AMsg. All headers, message parts, and the body of the message instance are cleared prior to storing values retrieved from the remote IMAP4 server. The value of the UID and Flags properties for the message in AMsg are updated based on the values found in the IMAP4 server response.&nbsp;</p>
<p class="Element10">
RetrievePeek creates an internal <a href="TIdTCPStream.html" target="topic">TIdTCPStream</a> instance to read message parts in the serve response, and assigns event handlers for the operation using procedure stored in <a href="TIdIMAP4_OnWorkBeginForPart.html" target="topic">OnWorkBeginForPart</a>, <a href="TIdIMAP4_OnWorkForPart.html" target="topic">OnWorkForPart</a>, and <a href="TIdIMAP4_OnWorkEndForPart.html" target="topic">OnWorkEndForPart</a>.&nbsp;</p>
<p class="Element10">
RetrievePeek sets the return value to True when the IMAP4 server response contains the value <a href="IMAP_OK.html" target="topic">IMAP_OK</a>.&nbsp;</p>
<p class="Element10">
Use <a href="TIdIMAP4_SelectMailBox@String.html" target="topic">SelectMailBox</a> or <a href="TIdIMAP4_ExamineMailBox@String@TIdMailBox.html" target="topic">ExamineMailBox</a> to select a mailbox and <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> messages or headers in Mailbox prior to calling the <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">Retrieve</a> or RetrievePeek methods.&nbsp;</p>
<p class="Element10">
Use on of the UIDRetrieveXxx methods to <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> message(s) using the unique identifier (UID) for a message in the selected mailbox.</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
<a href="TIdIMAP4_ConnectionState.html" target="topic">ConnectionState</a> <a href="TIdIMAP4_SelectMailBox@String.html" target="topic">SelectMailBox</a> <a href="TIdIMAP4_ExamineMailBox@String@TIdMailBox.html" target="topic">ExamineMailBox</a> <a href="EIdConnectionStateError.html" target="topic">EIdConnectionStateError</a> <a href="TIdMessage.html" target="topic">TIdMessage</a> <a href="TIdMessage_Headers.html" target="topic">TIdMessage.Headers</a> <a href="TIdMessage_Body.html" target="topic">TIdMessage.Body</a> <a href="TIdMessage_MessageParts.html" target="topic">TIdMessage.MessageParts</a> <a href="TIdMessage_UID.html" target="topic">TIdMessage.UID</a> <a href="TIdMessage_Flags.html" target="topic">TIdMessage.Flags</a></p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a><br /><a href="!!MEMBEROVERVIEW_TIdIMAP4.html" target="topic">TIdIMAP4 Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>