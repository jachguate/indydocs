<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdNNTP.GetNewGroupsList@TDateTime@boolean@string@TStrings</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdNNTP_GetNewGroupsList@TDateTime@boolean@string@TStrings.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: <a href="Pending.html" target="topic">Pending</a> &gt; <a href="TIdNNTP_GetNewGroupsList@TDateTime@boolean@string@TStrings.html" target="topic">TIdNNTP.GetNewGroupsList@TDateTime@boolean@string@TStrings</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdSunB_ReadStruct@TIdBytes@Integer.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><a href="Pending.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_up_midblue.gif');"></a><a href="TIdSunB_WriteStruct@TIdBytes@Integer.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdNNTP.GetNewGroupsList@TDateTime@boolean@string@TStrings</div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Parameters,Description,See_Also', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Parameters,Description,See_Also', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Retrieves a list of new newsgroups from an NNTP server.</p></div>
</div>
<a name="Parameters"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Parameters');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgParameters">Parameters</a></div>
<div id="divParameters">
<div class="Element11">
<div class="Element10">
<div class="Element252">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element240" valign="top" width="35%">
<div class="Element241">
Parameters&nbsp;</div></td><td class="Element244" valign="top" width="65%">
<div class="Element245">
Description&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
ADate&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Previous data and time the newsgroup list was retrieved.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AGMT&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Time is expressed in GMT.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
ADistributions&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Optional list of distribution patterns.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AList&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Destination for the new newsgroups from the NNTP server.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
GetNewGroupsList is an overloaded procedure in <a href="TIdNNTP.html" target="topic">TIdNNTP</a> that requests a list of newsgroups from the NNTP server which were added after a specific date and time. GetNewGroupsList is normally used to update a stored list of newsgroups on an NNTP client.&nbsp;</p>
<p class="Element10">
ADate represents the date and time that the newsgroup list on the NNTP client was last updated, and is used to determine which groups in list have been added since that update.&nbsp;</p>
<p class="Element10">
When AGMT is True, the value in ADate is based on Greenwich Mean Time or Universal Time Coordinated (0 meridian). When AGMT is False, the value in ADate represents a value for the local time-zone.&nbsp;</p>
<p class="Element10">
ADistributions is an optional string containing a comma-delimited list of newsgroup prefixes to be used as a filter when retrieving the list of news newsgroups.&nbsp;</p>
<p class="Element10">
For example, the following would limit newsgroup retrieval to the public Delphi and C++ Builder hierarchy:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element103"><div class="Element102"><pre class="Element102">'borland.public.delphi,borland.public.cppbuilder'</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
AList is a TStrings instance to be used as the destination for new newsgroups retrieved from the NNTP server. GetNewGroupsList calls SendCmd using the NNTP NEWGROUPS command with the arguments specified. GetNewGroupsList calls Capture to store the server response lines in AList.&nbsp;</p>
<p class="Element10">
Each line in AList is in the form:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element103"><div class="Element102"><pre class="Element102">groupname last first p</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
Where the tokens in the response lines have the following meanings:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element65" valign="top" width="10%">
<div class="Element66">
Token&nbsp;</div></td><td class="Element65" valign="top" width="90%">
<div class="Element66">
Meaning&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="10%">
<div class="Element68">
groupname&nbsp;</div></td><td class="Element67" valign="top" width="90%">
<div class="Element68">
newsgroup name.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="10%">
<div class="Element68">
last&nbsp;</div></td><td class="Element67" valign="top" width="90%">
<div class="Element68">
number of the last known article currently in the newsgroup.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="10%">
<div class="Element68">
first&nbsp;</div></td><td class="Element67" valign="top" width="90%">
<div class="Element68">
number of the first article currently in the newsgroup.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="10%">
<div class="Element68">
p&nbsp;</div></td><td class="Element67" valign="top" width="90%">
<div class="Element68">
posting status for the newsgroup. ('y'=allowed, 'n'=prohibited)&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
Use GetNewsgroupList to retrieve a list of all valid newsgroups on the NNTP server.</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
SendCmd OnNewGroupsList GetNewGroupsList TEventNewsgroupList <a href="EIdNNTPNoOnNewGroupsList.html" target="topic">EIdNNTPNoOnNewGroupsList</a></p></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>