<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdIMAP4.UIDRetrievePartPeek@String@String@TIdBytes@Integer@string</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdIMAP4_UIDRetrievePartPeek@String@String@TIdBytes@Integer@string1.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: <a href="Pending.html" target="topic">Pending</a> &gt; <a href="TIdIMAP4_UIDRetrievePartPeek@String@String@TIdBytes@Integer@string1.html" target="topic">TIdIMAP4.UIDRetrievePartPeek@String@String@TIdBytes@Integer@string</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdIMAP4_UIDRetrieveNoDecodeToStream@String@TStream.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><a href="Pending.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_up_midblue.gif');"></a><a href="TIdIMAP4_UIDRetrievePartPeek@String@String@PChar@Integer@string1.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdIMAP4.UIDRetrievePartPeek@String@String@TIdBytes@Integer@string</div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Parameters,Returns,Description,See_Also', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Parameters,Returns,Description,See_Also', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Retrieves a specified message part without affecting the flags stored for the message.</p></div>
</div>
<a name="Parameters"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Parameters');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgParameters">Parameters</a></div>
<div id="divParameters">
<div class="Element11">
<div class="Element10">
<div class="Element252">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element240" valign="top" width="35%">
<div class="Element241">
Parameters&nbsp;</div></td><td class="Element244" valign="top" width="65%">
<div class="Element245">
Description&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AMsgUID&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Unique identifier for the message with the desired message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
APartNum&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Relative part number for the message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
ABuffer&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Buffer for storing the retrieve message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
ABufferLength&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
SIze of the buffer need to store the message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AContentTransferEncoding&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Content transfer encoding applied to the stored message part.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="Returns"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Returns');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgReturns">Returns</a></div>
<div id="divReturns">
<div class="Element11">
<div class="Element10">
<p class="Element10">
Boolean - True on success.</p></div>
</div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
UIDRetrievePartPeek is an overloaded Boolean function used to retrieve a message part for a specific message without affecting the flags stored on the remote IMAP4 server for the message.&nbsp;</p>
<p class="Element10">
AMsgUID is the unique identifier (UID) for the message stored in the current mailbox on the remote IMAP4 server.&nbsp;</p>
<p class="Element10">
APartNum is the relative part number for the requested message part.&nbsp;</p>
<p class="Element10">
Use RetrieveStructure or UIDRetrieveStructure to find the message parts available for a specific message, and the content transfer encoding used for each of the message parts. Use the message part number (the relative position of the message part) and the content transfer encoding when calling RetrievePart or RetrievePartPeek.&nbsp;</p>
<p class="Element10">
ABuffer is the storage to use for the retrieved message part after decoding the message content using the algorithm specified in AContentTransferEncoding.&nbsp;</p>
<p class="Element10">
On successful retrieval of the message part, the values in ABuffer and ABufferLength are updated to reflect the message part content and length (respectively). Please note that the caller is responsible for freeing the memory allocated in ABuffer by calling FreeMem.&nbsp;</p>
<p class="Element10">
UIDRetrievePartPeek validates the message identifier in AMsgUID to ensure that it contains a valid value, and raises an <a href="EIdNumberInvalid.html" target="topic">EIdNumberInvalid</a> exception if the requirement is not met.&nbsp;</p>
<p class="Element10">
UIDRetrievePartPeek requires that ConnectionState contain the value csSelected, or an <a href="EIdConnectionStateError.html" target="topic">EIdConnectionStateError</a> exception will be raised. Use SelectMailBox or ExamineMailBox to select a mailbox prior to calling RetrievePartPeek or UIDRetrievePartPeek.&nbsp;</p>
<p class="Element10">
UIDRetrievePartPeek sends the IMAP4 FETCH command to retrieve the specified message part, and retrieves the message part content using a <a href="TIdTCPStream.html" target="topic">TIdTCPStream</a> instance. UIDRetrievePartPeek assigns the event handlers in OnWorkBeginForPart, OnWorkForPart, and OnWorkEndForPart to the <a href="TIdTCPStream.html" target="topic">TIdTCPStream</a> instance to respond to work events occurring during message part retrieval.&nbsp;</p>
<p class="Element10">
After retrieval of the message part, ABuffer will contain the decoded message part content and ABufferLength will contain the length of the decoded message part.&nbsp;</p>
<p class="Element10">
Please note that UIDRetrievePartPeek does not affect the message flags stored for the message. Specifically, it allows accessing the message parts without setting the 'Seen' message flag that indicates the message has been read.&nbsp;</p>
<p class="Element10">
Use RetrievePart or UIDRetrievePart to retrieve (and mark as seen) a specific message part.&nbsp;</p>
<p class="Element10">
Use RetrievePartToFilePeek or UIDRetrievePartToFilePeek to capture and store an unseen message part into a file on the local system.&nbsp;</p>
<p class="Element10">
Use RetrievePeek or UIDRetrievePeek to perform similar processing for the entire contents of a specified message.</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
RetrievePart RetrievePartPeek RetrievePartToFilePeek RetrievePeek RetrieveStructure UIDRetrievePart UIDRetrievePartPeek UIDRetrievePartToFilePeek UIDRetrievePeek UIDRetrieveStructure <a href="EIdNumberInvalid.html" target="topic">EIdNumberInvalid</a> <a href="EIdConnectionStateError.html" target="topic">EIdConnectionStateError</a> ConnectionState SelectMailBox ExamineMailBox OnWorkBeginForPart OnWorkForPart OnWorkEndForPart <a href="TIdTCPStream.html" target="topic">TIdTCPStream</a></p></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>