<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdAttachmentMemory Class</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdAttachmentMemory.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory Class</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdAttachmentFile_StoredPathName.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><img src="btn_up_d.gif" border="0" alt="Up" title="Up"><a href="!!MEMBEROVERVIEW_TIdAttachmentMemory.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdAttachmentMemory Class</div>
<div class="Element7">
<a href="!!MEMBERTYPE_Methods_TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory Methods</a> &nbsp; <a href="!!MEMBERTYPE_Properties_TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory Properties</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Hierarchy,Pascal,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Hierarchy,Pascal,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Encapsulates a MIME-encoded attachment or inline graphic using in-memory storage.</p></div>
</div>
<a name="File"></a><div class="Element14">
File</div>
<div class="Element10033">
<div class="Section33">
<p class="Section33">
<a href="IdAttachmentMemory_pas.html" target="topic">IdAttachmentMemory</a></p></div>
</div>
<a name="Hierarchy"></a><div class="Section1000032">
<a onclick="toggleVisibilityStored('Hierarchy');" class="a_Section1000032"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgHierarchy">Hierarchy</a></div>
<div id="divHierarchy">
<div class="Element151"><div class="Element150"><pre class="Element150"><img src="TIdAttachmentMemory.png" border="0" alt="" title="" usemap="#TIdAttachmentMemory"><map class="Element150" name="TIdAttachmentMemory"><area class="Element150" shape="rect" coords="123,0,209,15" href="TIdMessagePart.html"><area class="Element150" shape="rect" coords="239,0,320,15" href="TIdAttachment.html"><area class="Element150" shape="rect" coords="350,0,466,15" href="TIdAttachmentMemory.html"></map></pre></div></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100">TIdAttachmentMemory = <strong>class</strong>(TIdAttachment);</pre></div></div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
TIdAttachmentMemory is a <a href="TIdAttachment.html" target="topic">TIdAttachment</a> descendant that implements a MIME-encoded attachment or inline graphic using in-memory storage for the contents of the message part.&nbsp;</p>
<p class="Element10">
TIdAttachmentMemory publishes properties that provide access to memory used to store the message part using string- or stream-based access methods.&nbsp;</p>
<p class="Element10">
TIdAttachmentMemory implements an internal TMemoryStream stream used to read or write the contents of the message part during transmission and receipt.&nbsp;</p>
<p class="Element10">
TIdAttachmentMemory implements the abstract virtual methods from <a href="TIdAttachment.html" target="topic">TIdAttachment</a> needed to retrieve and store the contents of the message part using a stream.&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element15">
Sending a Message with In-Memory Attachments</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
For sending a message with attachments, the following abstract virtual methods are overridden and reimplemented:&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601"><a href="TIdAttachmentMemory_Create@TIdCollection.html" target="topic">Create</a></li>
<li class="Element601"><a href="TIdAttachmentMemory_OpenLoadStream.html" target="topic">OpenLoadStream</a></li>
<li class="Element601"><a href="TIdAttachmentMemory_CloseLoadStream.html" target="topic">CloseLoadStream</a></li>
</ul>&nbsp;</p>
<p class="Element10">
The <a href="TIdAttachmentMemory_Create@TIdCollection.html" target="topic">Create</a> constructor is overloaded to accept either a string or stream argument that contains the contents of the attachment.&nbsp;</p>
<p class="Element10">
When a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance is transmitted using <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a>, or a descendant class, the overridden <a href="TIdAttachmentMemory_OpenLoadStream.html" target="topic">OpenLoadStream</a> and <a href="TIdAttachmentMemory_CloseLoadStream.html" target="topic">CloseLoadStream</a> in the attachment are called.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachmentMemory_OpenLoadStream.html" target="topic">OpenLoadStream</a> creates a stream used for loading the contents of the message part. During transmission, values in the internal stream are encoded based on the properties specified in the message or message part in <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a> methods like SendHeader and SendBody.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachmentMemory_CloseLoadStream.html" target="topic">CloseLoadStream</a> ensures that the internal stream for accessing data in the message part is reset to its initial position when all values have been read during transmission.&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element15">
Accessing or Receiving a message with In-Memory Attachments</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
When loading or receiving a message with in-memory attachments, the following abstract virtual are overridden and reimplemented:&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601"><a href="TIdAttachmentMemory_PrepareTempStream.html" target="topic">PrepareTempStream</a></li>
<li class="Element601"><a href="TIdAttachmentMemory_FinishTempStream.html" target="topic">FinishTempStream</a></li>
</ul>&nbsp;</p>
<p class="Element10">
When a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance is received and processed using <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a>, or a descendant class, the overridden <a href="TIdAttachmentMemory_PrepareTempStream.html" target="topic">PrepareTempStream</a> and <a href="TIdAttachmentMemory_FinishTempStream.html" target="topic">FinishTempStream</a> methods for the in-memory attachment are called. These methods apply to both receiving a message from a remote mail server or accessing a message from a local mail store. Essentially, the actions are the same - differing only in the type of stream used to read the message contents.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachmentMemory_PrepareTempStream.html" target="topic">PrepareTempStream</a> ensures that the temporary stream used for processing the contents of the message part is reset to it beginning prior to reading values to be stored in a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachmentMemory_FinishTempStream.html" target="topic">FinishTempStream</a> ensures that the temporary stream used for processing the contents of the message part is reset to it beginning after reading values stored in a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance.&nbsp;</p>
<p class="Element10">
The ProcessMessage, ReceiveHeader, and ReceiveBody methods in <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a> rely on the overridden methods.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachment.html" target="topic">TIdAttachment</a>, <a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile</a>, TIdAttachmentMemory, and <a href="TIdText.html" target="topic">TIdText</a> are used as collection items in the <a href="TIdMessageParts.html" target="topic">TIdMessageParts</a> collection.&nbsp;</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
<a href="TIdMessagePart.html" target="topic">TIdMessagePart</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdMessage_MessageParts.html" target="topic">TIdMessage.MessageParts</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdText.html" target="topic">TIdText</a>&nbsp;</p>
<p class="Section9">
 TIdAttachmentMemory&nbsp;</p>
<p class="Section9">
 <a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdAttachment.html" target="topic">TIdAttachment</a>&nbsp;</p>
<p class="Section9">
 <a href="IndySupport.html" target="topic">IndySupport</a></p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="!!MEMBERTYPE_Methods_TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory Methods</a><br /><a href="!!MEMBERTYPE_Properties_TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory Properties</a><br /><a href="!!MEMBEROVERVIEW_TIdAttachmentMemory.html" target="topic">TIdAttachmentMemory Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>