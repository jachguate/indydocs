<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdEncoderBinHex4 Class</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdEncoderBinHex4.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdEncoderBinHex4.html" target="topic">TIdEncoderBinHex4 Class</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdEncoder3to4_FillChar.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><img src="btn_up_d.gif" border="0" alt="Up" title="Up"><a href="!!MEMBEROVERVIEW_TIdEncoderBinHex4.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdEncoderBinHex4 Class</div>
<div class="Element7">
<a href="!!MEMBERTYPE_Methods_TIdEncoderBinHex4.html" target="topic">TIdEncoderBinHex4 Methods</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdEncoderBinHex4.html" target="topic">TIdEncoderBinHex4 Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Hierarchy,Pascal,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Hierarchy,Pascal,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Implements an encoder for Apple BinHex 4.0 content.</p></div>
</div>
<a name="File"></a><div class="Element14">
File</div>
<div class="Element10033">
<div class="Section33">
<p class="Section33">
<a href="IdCoderBinHex4_pas.html" target="topic">IdCoderBinHex4</a></p></div>
</div>
<a name="Hierarchy"></a><div class="Section1000032">
<a onclick="toggleVisibilityStored('Hierarchy');" class="a_Section1000032"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgHierarchy">Hierarchy</a></div>
<div id="divHierarchy">
<div class="Element151"><div class="Element150"><pre class="Element150"><img src="TIdEncoderBinHex4.png" border="0" alt="" title="" usemap="#TIdEncoderBinHex4"><map class="Element150" name="TIdEncoderBinHex4"><area class="Element150" shape="rect" coords="139,0,257,15" href="TIdInitializerComponent.html"><area class="Element150" shape="rect" coords="287,0,388,15" href="TIdBaseComponent.html"><area class="Element150" shape="rect" coords="418,0,484,15" href="TIdEncoder.html"><area class="Element150" shape="rect" coords="514,0,598,15" href="TIdEncoder3to4.html"><area class="Element150" shape="rect" coords="628,0,728,15" href="TIdEncoderBinHex4.html"></map></pre></div></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100">TIdEncoderBinHex4 = <strong>class</strong>(TIdEncoder3to4);</pre></div></div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
TIdEncoderBinHex4 is a <a href="TIdEncoder3to4.html" target="topic">TIdEncoder3to4</a> descendant that implements an encoder for Apple BinHex 4.0 formatted content, as described in the Internet Standards document:&nbsp;</p>
<p class="Element10">
<a href="http://www.rfc-editor.org/rfc/rfc1741.txt"> RFC 1741 - MIME Content Type for BinHex Encoded Files </a>&nbsp;</p>
<p class="Element10">
TIdEncoderBinHex4 is a variant of a 4-byte-to-3-byte encoder, but it uses ASCII character 90 for sequences of repeating characters, allowing some compression, but thereby not allowing it to be mapped in as another 3-to-4 decoder.&nbsp;</p>
<p class="Element10">
As per the RFC, BinHex encoded data must be encapsulated in a MIME part (it cannot be directly coded inline in an email &quot;body&quot;), the part is strictly defined to have a header entry (with the appropriate &quot;myfile.ext&quot;):&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element103"><div class="Element102"><pre class="Element102">  Content-Type: application/mac-binhex40; name=&quot;myfile.ext&quot;</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
After the header, the part must start with the text (not indented):&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element103"><div class="Element102"><pre class="Element102">  (This file must be converted with BinHex 4.0)</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
This allows the option and the ambiguity of identifying it by either the Content-Type or by the initial text line. However, it is also stated that any text before the specified text line must be ignored, implying the line does not have to be the first - an apparent contradiction. The encoded file then follows, split with CRLFs (to avoid lines that are too long for emails) that must be discarded.&nbsp;</p>
<p class="Element10">
The file starts with a colon (:), a header, followed by the file contents, and ending in another colon.&nbsp;</p>
<p class="Element10">
There is also an interesting article on the web, &quot;BinHex 4.0 Definition by Peter N Lewis, Aug 1991&quot;, which has very useful information on what is implemeted in practice, and seems to come with the good provenance of bitter experience.&nbsp;</p>
<p class="Element10">
<strong>The BinHex format</strong>&nbsp;</p>
<p class="Element10">
Here is a description of the Hqx7 (7 bit format as implemented in BinHex 4.0) formats for Macintosh Application and File transfers.&nbsp;</p>
<p class="Element10">
The main features of the format are:&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601">Error checking even using ASCII download</li>
<li class="Element601">Compression of repetitive characters</li>
<li class="Element601">7-bit encoding for ASCII download</li>
</ul>&nbsp;</p>
<p class="Element10">
BinHex format is processed at three different levels:&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601">8 bit encoding of the file:</li>
</ul>&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element65" valign="top" width="22%">
<div class="Element66">
Data Type&nbsp;</div></td><td class="Element65" valign="top" width="78%">
<div class="Element66">
Description&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Byte&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Length of the FileName (1..63)&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Bytes&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
FileName bytes (up to &quot;Length&quot; bytes)&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Byte&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
<a href="TIdBaseComponent_Version.html" target="topic">Version</a>&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Long&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Type&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Long&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Creator&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Word&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Flags (And $F800)&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Long&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Length of Data Fork&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Long&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Length of Resource Fork&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Word&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
CRC&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Bytes&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Data Fork (&quot;Data Length&quot; bytes)&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Word&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
CRC&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Bytes&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
Resource Fork (&quot;Rsrc Length&quot; bytes)&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
Word&nbsp;</div></td><td class="Element67" valign="top" width="78%">
<div class="Element68">
CRC&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601">Compression of repetitive characters. $90 is the marker, and encoding is made for 3-255 characters.</li>
</ul>&nbsp;</p>
<div class="Element103"><div class="Element102"><pre class="Element102">00 11 22 33 44 55 66 77   -&gt; 00 11 22 33 44 55 66 77
11 22 22 22 22 22 22 33   -&gt; 11 22 90 06 33
11 22 90 33 44            -&gt; 11 22 90 00 33 44</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
The whole file is considered as a stream of bits. This stream will be divided in blocks of 6 bits and then converted to one of 64 characters contained in a table. The characters in this table have been chosen for maximum noise protection. The format will start with a &quot;:&quot; (first character on a line) and end with a &quot;:&quot;. There will be a maximum of 64 characters on a line. It must be preceded, by this comment, starting in column 1 (it does not start in column 1 in this document):&nbsp;</p>
<p class="Element10">
(This file must be converted with BinHex 4.0)&nbsp;</p>
<p class="Element10">
Any text before this comment is to be ignored.&nbsp;</p>
<p class="Element10">
Use <a href="GBinHex4CodeTable.html" target="topic">GBinHex4CodeTable</a> to access the characters used in the encoded file format.&nbsp;</p>
<p class="Element10">
<strong>Implementation Notes</strong>&nbsp;</p>
<p class="Element10">
There are older variants referred to in RFC 1741, but I have only come across encodings in current use as separate MIME parts, which this implementation is targetted at.&nbsp;</p>
<p class="Element10">
When encoding into BinHex4, you do NOT have to implement the run-length encoding (the character 90 for sequences of repeating characters), and this encoder does not do it. The CRC values generated in the header have NOT been tested (because this decoder ignores them).&nbsp;</p>
<p class="Element10">
The decoder has to allow for the run-length encoding. The decoder works irrespective of whether it is preceded by the identification string or not (<a href="GBinHex4IdentificationString.html" target="topic">GBinHex4IdentificationString</a> below). The string to be decoded must include the starting and ending colons. It can deal with embedded <a href="CR.html" target="topic">CR</a> and LFs. Unlike base64 and quoted-printable, we cannot decode line-by-line cleanly, because the lines do not contain a clean number of 4-byte blocks due to the first line starting with a colon, leaving 63 bytes on that line, plus you have the problem of dealing with the run-length encoding and stripping the header. If the attachment only has a data fork, it is saved; if only a resource fork, it is saved; if both, only the data fork is saved. The decoder does NOT check that the CRC values are correct.&nbsp;</p>
<p class="Element10">
Indy units use the content-type to decide if the part is BinHex4:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element103"><div class="Element102"><pre class="Element102">  Content-Type: application/mac-binhex40; name=&quot;myfile.ext&quot;</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
WARNING: This code only implements BinHex4.0 when used as a part in a MIME-encoded email. To have a part encoded, set the value in the content transfer property for the message part:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element103"><div class="Element102"><pre class="Element102">  ContentTransfer := 'binhex40'.</pre></div></div>
</div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
<a href="TIdEncoder3to4.html" target="topic">TIdEncoder3to4</a></p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="!!MEMBERTYPE_Methods_TIdEncoderBinHex4.html" target="topic">TIdEncoderBinHex4 Methods</a><br /><a href="!!MEMBEROVERVIEW_TIdEncoderBinHex4.html" target="topic">TIdEncoderBinHex4 Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>