<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdIMAP4.GetUID Method</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdIMAP4_GetUID@Integer@string.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a> &gt; <a href="!!MEMBERTYPE_Methods_TIdIMAP4.html" target="topic">TIdIMAP4 Methods</a> &gt; <a href="TIdIMAP4_GetUID@Integer@string.html" target="topic">GetUID Method</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdIMAP4_GetResponse.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><a href="!!MEMBERTYPE_Methods_TIdIMAP4.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_up_midblue.gif');"></a><a href="TIdIMAP4_InternalRetrieveStructure@Integer@TIdMessage@TIdImapMessageParts.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdIMAP4.GetUID Method</div>
<div class="Element7">
<a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdIMAP4.html" target="topic">TIdIMAP4 Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Pascal,Parameters,Returns,Description,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Pascal,Parameters,Returns,Description,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Retrieves the unique identifier for a given relative message number.</p></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100"><strong>function</strong> GetUID(
    <strong>const</strong> AMsgNum: Integer; 
    <strong>var</strong> AUID: <strong>string</strong>
): Boolean;</pre></div></div>
</div>
<a name="Parameters"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Parameters');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgParameters">Parameters</a></div>
<div id="divParameters">
<div class="Element11">
<div class="Element10">
<div class="Element252">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element240" valign="top" width="35%">
<div class="Element241">
Parameters&nbsp;</div></td><td class="Element244" valign="top" width="65%">
<div class="Element245">
Description&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AMsgNum&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Message number (relative)<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AUID&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
destination for the retrieved UID&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="Returns"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Returns');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgReturns">Returns</a></div>
<div id="divReturns">
<div class="Element11">
<div class="Element10">
<p class="Element10">
Boolean - True on success.</p></div>
</div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
GetUID is a Bollean function used to <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> the UID (unique identifier) for a specified relative message number. GetUID allows the user to switch from relative message numbers to UIDs.&nbsp;</p>
<p class="Element10">
Please note that <a href="TIdIMAP4.html" target="topic">TIdIMAP4</a> stores the UID as a string rather than a number (it is defined as a number in the RFCs) for historical reasons but is simply converted to a number via StrToInt should you wish to do so. Storing it as a string rather than a number is of no practical consequence or disadvantage, and changing it in <a href="TIdIMAP4.html" target="topic">TIdIMAP4</a> would only break existing code.&nbsp;</p>
<p class="Element10">
The IMAP protocol uses two methods for message numbering: &quot;relative&quot; message numbers and UIDs. &quot;Relative&quot; message numbers are sequential numbers starting from 1 for each message in a mailbox - this is just the index number of the message in the <a href="TIdMailBox.html" target="topic">TIdMailBox</a> plus 1 (the first index is 0 in <a href="TIdMailBox.html" target="topic">TIdMailBox</a> and 1 on the IMAP server). UIDs are unique numbers assigned by the IMAP server, which rarely, if ever, change. While they can theoretically be changed as per the IMAP protocol, they certainly should not change during the period you have a mailbox open. While you may be able to get away with using the relative message number, you will get into difficulties if two sessions are accessing the same mailbox, and one of them deletes a message - the relative message for the other session will then be incorrect. As an example, this can arise where a manager and his/her secretary are accessing the manager's mailbox. Even if you are using UIDs, this also gives the problem that the second session may also try to modify the deleted message, but the solution is to always call the <a href="TIdIMAP4_UIDRetrieveFlags@String@TIdMessageFlagsSet.html" target="topic">UIDRetrieveFlags</a> function before you try to modify the message - it will return False if the message has been deleted.&nbsp;</p>
<p class="Element10">
IMAP implements a mechanism for checking if UIDs are valid over long periods. This can be useful in certain circumstances where you may need to keep track of a message between sessions or over long periods, such as weeks. A possible application that would do this is one that monitors a particular mailbox, such as sales leads, to ensure that someone reads them, and if they do not after say a week, emails an administrator to assign someone to read them. In that case, you don't want to <a href="TIdBaseComponent_Create@TComponent.html" target="topic">create</a> a high load on the IMAP server by continually scanning through the mailbox. While there are different methods of doing this, one way is to periodically call <a href="TIdIMAP4_UIDCheckMsgSeen@String.html" target="topic">UIDCheckMsgSeen</a> or <a href="TIdIMAP4_UIDRetrieveFlags@String@TIdMessageFlagsSet.html" target="topic">UIDRetrieveFlags</a> for the given UID. The only potential problem you have is the unlikely/infrequent possibility of some other program re-ordering the mailbox, which will make your UIDs invalid.&nbsp;</p>
<p class="Element10">
The return value for the method indicates if the UID was successfully retrieved for the specified relative message number.&nbsp;</p>
<p class="Element10">
GetUID validates the value in AMsgNum to ensure that it contains a positive non-zero value. An <a href="EIdNumberInvalid.html" target="topic">EIdNumberInvalid</a> exception is raised when the relative message number contains an invalid value.&nbsp;</p>
<p class="Element10">
GetUID requires that <a href="TIdIMAP4_ConnectionState.html" target="topic">ConnectionState</a> contain the value csSelected, indicating that a mailbox has been previously selected using <a href="TIdIMAP4_SelectMailBox@String.html" target="topic">SelectMailBox</a>, or an <a href="EIdConnectionStateError.html" target="topic">EIdConnectionStateError</a> exception is raised.&nbsp;</p>
<p class="Element10">
GetUID calls <a href="TIdIMAP4_SendCmd@string@array_of_String.html" target="topic">SendCmd</a> to send the IMAP4 FETCH command using the values in AMsgNum and the fetch data item for the UID value. Some servers return NO if the requested message number is not present (e.g. Cyrus), others return <a href="OK.html" target="topic">OK</a> but no data (CommuniGate). If the server response contains the value <a href="IMAP_OK.html" target="topic">IMAP_OK</a>, the values in <a href="TIdTCPConnection_LastCmdResult.html" target="topic">LastCmdResult</a> are parsed to determine the UID value.&nbsp;</p>
<p class="Element10">
To check if your UIDs have changed, use <a href="TIdIMAP4_StatusMailBox@String@TIdMailBox.html" target="topic">StatusMailBox</a> command and check for changes to the UIDValidity field - the IMAP protocol guarantees that the server will change this value if it changes the UIDs of any existing messages.</p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a><br /><a href="!!MEMBEROVERVIEW_TIdIMAP4.html" target="topic">TIdIMAP4 Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>