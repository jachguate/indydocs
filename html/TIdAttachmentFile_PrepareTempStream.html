<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdAttachmentFile.PrepareTempStream Method</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdAttachmentFile_PrepareTempStream.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile Class</a> &gt; <a href="!!MEMBERTYPE_Methods_TIdAttachmentFile.html" target="topic">TIdAttachmentFile Methods</a> &gt; <a href="TIdAttachmentFile_PrepareTempStream.html" target="topic">PrepareTempStream Method</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdAttachmentFile_OpenLoadStream.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><a href="!!MEMBERTYPE_Methods_TIdAttachmentFile.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_up_midblue.gif');"></a><a href="TIdAttachmentFile_SaveToFile@String.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdAttachmentFile.PrepareTempStream Method</div>
<div class="Element7">
<a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile Class</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdAttachmentFile.html" target="topic">TIdAttachmentFile Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Pascal,Returns,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Pascal,Returns,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Provides a stream for accessing the contents of the message part.</p></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100"><strong>function</strong> PrepareTempStream: TIdStream; <strong>override</strong>;</pre></div></div>
</div>
<a name="Returns"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Returns');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgReturns">Returns</a></div>
<div id="divReturns">
<div class="Element11">
<div class="Element10">
<p class="Element10">
TStream - Stream containing the contents for the message part.</p></div>
</div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
PrepareTempStream is an overridden TStream function that implements the method used to obtain a stream containing data for the message part.&nbsp;</p>
<p class="Element10">
PrepareTempStream is called when loading or receiving a message with file attachments. When a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance is received and processed using <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a>, or a descendant class, the overridden PrepareTempStream and <a href="TIdAttachmentFile_FinishTempStream.html" target="topic">FinishTempStream</a> methods for the attachment are called. These methods apply to both receiving a message from a remote mail server or accessing a message from a local mail store. Essentially, loading a message and receiving a message are the same - differing only in the type of stream used to read the message contents.&nbsp;</p>
<p class="Element10">
<a href="TIdAttachmentFile_FinishTempStream.html" target="topic">FinishTempStream</a> is used to ensure that the temporary stream used for processing the contents of the message part is freed after reading values stored in the message part.&nbsp;</p>
<p class="Element10">
PrepareTempStream ensures that the temporary stream used for processing the contents of the message part is created prior to reading values to be stored in a <a href="TIdMessage.html" target="topic">TIdMessage</a> instance.&nbsp;</p>
<p class="Element10">
The ProcessMessage, ReceiveHeader, and ReceiveBody methods in <a href="TIdMessageClient.html" target="topic">TIdMessageClient</a> rely on the overridden methods.&nbsp;</p>
<p class="Element10">
PrepareTempStream sets <a href="TIdAttachmentFile_StoredPathName.html" target="topic">StoredPathName</a> to a temporary file name generated using <a href="MakeTempFilename@String.html" target="topic">MakeTempFilename</a>, and sets FileIsTemp to True.&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element15">
Warning:</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
PrepareLoadStream causes the value in <a href="TIdAttachmentFile_FileIsTempFile.html" target="topic">FileIsTempFile</a> to be changed to True when the file stream is created for the file name specified in <a href="TIdAttachmentFile_StoredPathName.html" target="topic">StoredPathName</a>. Setting <a href="TIdAttachmentFile_FileIsTempFile.html" target="topic">FileIsTempFile</a> to True will permanently delete the attachment file created when the message is freed. This behavior differs from previous versions of Indy, where the file was assumed to be permanent storage for the message part.&nbsp;</p>
<p class="Element10">
Make sure all content in the message or message part has been saved prior to calling <a href="TIdAttachmentFile_Destroy.html" target="topic">Destroy</a> for the <a href="TIdMessage.html" target="topic">TIdMessage</a> or the <a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile</a>.</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
<a href="TIdAttachmentFile_FinishTempStream.html" target="topic">TIdAttachmentFile.FinishTempStream</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdAttachment_FinishTempStream.html" target="topic">TIdAttachment.FinishTempStream</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdAttachment_PrepareTempStream.html" target="topic">TIdAttachment.PrepareTempStream</a>&nbsp;</p>
<p class="Section9">
 <a href="TIdMessage_LoadFromFile@string@Boolean.html" target="topic">TIdMessage.LoadFromFile</a>&nbsp;</p>
<p class="Section9">
 TIdMessage.ProcessMessage&nbsp;</p>
<p class="Section9">
 TIdMessage.ReceiveHeader&nbsp;</p>
<p class="Section9">
 TIdMessage.ReceiveBody</p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="TIdAttachmentFile.html" target="topic">TIdAttachmentFile Class</a><br /><a href="!!MEMBEROVERVIEW_TIdAttachmentFile.html" target="topic">TIdAttachmentFile Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>