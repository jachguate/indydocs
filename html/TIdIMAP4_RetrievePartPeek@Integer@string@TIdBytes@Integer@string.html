<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdIMAP4.RetrievePartPeek Method (Integer, string, TIdBytes, Integer, string)</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdIMAP4_RetrievePartPeek@Integer@string@TIdBytes@Integer@string.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a> &gt; <a href="!!MEMBERTYPE_Methods_TIdIMAP4.html" target="topic">TIdIMAP4 Methods</a> &gt; <a href="!!OVERLOADED_RetrievePartPeek_TIdIMAP4.html" target="topic">RetrievePartPeek Method</a> &gt; <a href="TIdIMAP4_RetrievePartPeek@Integer@string@TIdBytes@Integer@string.html" target="topic">RetrievePartPeek Method (Integer, string, TIdBytes, Integer, string)</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdIMAP4_RetrievePartPeek@Integer@string@PChar@Integer@string.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><a href="!!OVERLOADED_RetrievePartPeek_TIdIMAP4.html" target="topic"><img src="btn_up_midblue.gif" border="0" alt="Up" title="Up" onmouseover="switchImage(this, 'btn_up_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_up_midblue.gif');"></a><a href="TIdIMAP4_RetrievePartPeek@Integer@string@TIdStream@string.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdIMAP4.RetrievePartPeek Method (Integer, string, TIdBytes, Integer, string)</div>
<div class="Element7">
<a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdIMAP4.html" target="topic">TIdIMAP4 Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Pascal,Parameters,Returns,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Pascal,Parameters,Returns,Description,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Retrieves a specified message part without affecting the flags stored for the message.</p></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100"><strong>function</strong> RetrievePartPeek(
    <strong>const</strong> AMsgNum: Integer; 
    <strong>const</strong> APartNum: <strong>string</strong>; 
    <strong>var</strong> ABuffer: TIdBytes; 
    <strong>var</strong> ABufferLength: Integer; 
    AContentTransferEncoding: <strong>string</strong> = 'text'
): Boolean; <strong>overload</strong>;</pre></div></div>
</div>
<a name="Parameters"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Parameters');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgParameters">Parameters</a></div>
<div id="divParameters">
<div class="Element11">
<div class="Element10">
<div class="Element252">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element240" valign="top" width="35%">
<div class="Element241">
Parameters&nbsp;</div></td><td class="Element244" valign="top" width="65%">
<div class="Element245">
Description&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AMsgNum&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Relative message number for the message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
APartNum&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Relative part number for the message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
ABuffer&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Buffer for storing the <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
ABufferLength&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
SIze of the buffer need to store the message part.<br>&nbsp;</div></td></tr><tr>
<td class="Element242" valign="top" width="35%">
<div class="Element243">
AContentTransferEncoding&nbsp;</div></td><td class="Element246" valign="top" width="65%">
<div class="Element247">
Content transfer encoding applied to the stored message part.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<a name="Returns"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Returns');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgReturns">Returns</a></div>
<div id="divReturns">
<div class="Element11">
<div class="Element10">
<p class="Element10">
Boolean - True on success.</p></div>
</div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
RetrievePartPeek is an overloaded Boolean function used to <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> a message part for a specific message without affecting the flags stored on the remote IMAP4 server for the message.&nbsp;</p>
<p class="Element10">
AMsgNum is the relative message number for the message stored in the current mailbox on the remote IMAP4 server.&nbsp;</p>
<p class="Element10">
APartNum is the relative part number for the requested message part.&nbsp;</p>
<p class="Element10">
Use <a href="TIdIMAP4_RetrieveStructure@Integer@TIdImapMessageParts.html" target="topic">RetrieveStructure</a> to find the message parts available for a specific message, and the content transfer encoding used for each of the message parts. Use the message part number (the relative position of the message part) and the content transfer encoding when calling <a href="TIdIMAP4_RetrievePart@Integer@Integer@PChar@Integer@string.html" target="topic">RetrievePart</a> or RetrievePartPeek.&nbsp;</p>
<p class="Element10">
ABuffer is the storage to use for the retrieved message part after decoding the message content using the algorithm specified in AContentTransferEncoding.&nbsp;</p>
<p class="Element10">
On successful retrieval of the message part, the values in ABuffer and ABufferLength are updated to reflect the message part content and length (respectively). Please note that the caller is responsible for freeing the memory allocated in ABuffer by calling FreeMem.&nbsp;</p>
<p class="Element10">
RetrievePartPeek validates the message number in AMsgNum to ensure that it contains a positive non-zero value, and raises an <a href="EIdNumberInvalid.html" target="topic">EIdNumberInvalid</a> exception if the requirement is not met.&nbsp;</p>
<p class="Element10">
RetrievePartPeek requires that <a href="TIdIMAP4_ConnectionState.html" target="topic">ConnectionState</a> contain the value csSelected, or an <a href="EIdConnectionStateError.html" target="topic">EIdConnectionStateError</a> exception will be raised. Use <a href="TIdIMAP4_SelectMailBox@String.html" target="topic">SelectMailBox</a> or <a href="TIdIMAP4_ExamineMailBox@String@TIdMailBox.html" target="topic">ExamineMailBox</a> to select a mailbox prior to calling RetrievePartPeek.&nbsp;</p>
<p class="Element10">
RetrievePartPeek sends the IMAP4 FETCH command to <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> the specified message part, and retrieves the message part content using a <a href="TIdTCPStream.html" target="topic">TIdTCPStream</a> instance. RetrievePartPeek assigns the event handlers in <a href="TIdIMAP4_OnWorkBeginForPart.html" target="topic">OnWorkBeginForPart</a>, <a href="TIdIMAP4_OnWorkForPart.html" target="topic">OnWorkForPart</a>, and <a href="TIdIMAP4_OnWorkEndForPart.html" target="topic">OnWorkEndForPart</a> to the <a href="TIdTCPStream.html" target="topic">TIdTCPStream</a> instance to respond to work events occurring during message part retrieval.&nbsp;</p>
<p class="Element10">
After retrieval of the message part, ABuffer will contain the decoded message part content and ABufferLength will contain the length of the decoded message part.&nbsp;</p>
<p class="Element10">
Please note that RetrievePartPeek does not affect the message flags stored for the message. Specifically, it allows accessing the message parts without setting the 'Seen' message flag that indicates the message has been read.&nbsp;</p>
<p class="Element10">
Use <a href="TIdIMAP4_RetrievePart@Integer@Integer@PChar@Integer@string.html" target="topic">RetrievePart</a> or <a href="TIdIMAP4_UIDRetrievePart@String@Integer@PChar@Integer@string.html" target="topic">UIDRetrievePart</a> to <a href="TIdIMAP4_Retrieve@Integer@TIdMessage.html" target="topic">retrieve</a> (and mark as seen) a specific message part.&nbsp;</p>
<p class="Element10">
Use <a href="TIdIMAP4_RetrievePartToFilePeek@Integer@Integer@Integer@string@string.html" target="topic">RetrievePartToFilePeek</a> to capture and store an unseen message part into a file on the local system.&nbsp;</p>
<p class="Element10">
Use <a href="TIdIMAP4_RetrievePeek@Integer@TIdMessage.html" target="topic">RetrievePeek</a> or <a href="TIdIMAP4_UIDRetrievePeek@String@TIdMessage.html" target="topic">UIDRetrievePeek</a> to perform similar processing for the entire contents of a specified message.</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
RetrievePartPeek <a href="TIdIMAP4_RetrievePart@Integer@Integer@PChar@Integer@string.html" target="topic">RetrievePart</a> <a href="TIdIMAP4_RetrieveStructure@Integer@TIdImapMessageParts.html" target="topic">RetrieveStructure</a> <a href="EIdNumberInvalid.html" target="topic">EIdNumberInvalid</a> <a href="EIdConnectionStateError.html" target="topic">EIdConnectionStateError</a> <a href="TIdIMAP4_ConnectionState.html" target="topic">ConnectionState</a> <a href="TIdIMAP4_SelectMailBox@String.html" target="topic">SelectMailBox</a> <a href="TIdIMAP4_ExamineMailBox@String@TIdMailBox.html" target="topic">ExamineMailBox</a> <a href="TIdIMAP4_UIDRetrievePart@String@Integer@PChar@Integer@string.html" target="topic">UIDRetrievePart</a> <a href="TIdIMAP4_RetrievePartToFilePeek@Integer@Integer@Integer@string@string.html" target="topic">RetrievePartToFilePeek</a> <a href="TIdIMAP4_RetrievePeek@Integer@TIdMessage.html" target="topic">RetrievePeek</a> <a href="TIdIMAP4_UIDRetrievePeek@String@TIdMessage.html" target="topic">UIDRetrievePeek</a> <a href="TIdIMAP4_OnWorkBeginForPart.html" target="topic">OnWorkBeginForPart</a> <a href="TIdIMAP4_OnWorkForPart.html" target="topic">OnWorkForPart</a> <a href="TIdIMAP4_OnWorkEndForPart.html" target="topic">OnWorkEndForPart</a> <a href="TIdTCPStream.html" target="topic">TIdTCPStream</a></p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="TIdIMAP4.html" target="topic">TIdIMAP4 Class</a><br /><a href="!!MEMBEROVERVIEW_TIdIMAP4.html" target="topic">TIdIMAP4 Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>