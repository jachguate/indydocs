<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TIdSMTPRelay Class</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', 'TIdSMTPRelay.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
Topic Path: Symbol Reference &gt; Classes &gt; <a href="TIdSMTPRelay.html" target="topic">TIdSMTPRelay Class</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="50%">
<div class="Element2">
<a href="contents.html" target="tocidx"><img src="btn_globals_contents_midblue.gif" border="0" alt="Contents" title="Contents" onmouseover="switchImage(this, 'btn_globals_contents_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_contents_midblue.gif');"></a><a href="idx.html" target="tocidx"><img src="btn_globals_index_midblue.gif" border="0" alt="Index" title="Index" onmouseover="switchImage(this, 'btn_globals_index_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_index_midblue.gif');"></a><a href="index.html" target="topic"><img src="btn_globals_home_midblue.gif" border="0" alt="Home" title="Home" onmouseover="switchImage(this, 'btn_globals_home_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_globals_home_midblue.gif');"></a></div>
</td><td width="50%">
<div class="Element90">
<a href="TIdSMTPEnhancedCode_Subject.html" target="topic"><img src="btn_prev_midblue.gif" border="0" alt="Previous" title="Previous" onmouseover="switchImage(this, 'btn_prev_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_prev_midblue.gif');"></a><img src="btn_up_d.gif" border="0" alt="Up" title="Up"><a href="!!MEMBEROVERVIEW_TIdSMTPRelay.html" target="topic"><img src="btn_next_midblue.gif" border="0" alt="Next" title="Next" onmouseover="switchImage(this, 'btn_next_midblue_hover.gif');" onmouseout="switchImage(this, 'btn_next_midblue.gif');"></a></div>
</td></tr></table><div class="Element5">
TIdSMTPRelay Class</div>
<div class="Element7">
<a href="!!MEMBERTYPE_Methods_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Methods</a> &nbsp; <a href="!!MEMBERTYPE_Properties_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Properties</a> &nbsp; <a href="!!MEMBERTYPE_Events_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Events</a> &nbsp; <a href="!!MEMBEROVERVIEW_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Members</a></div>
<div class="Element731">
<div class="Element730">
<a href="#" onclick="ToggleAllElements('Hierarchy,Pascal,Description,Todo,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');"><img src="btn_collapse.gif" border="0" alt="" title="" id="imgToggleAllElements"></a><a href="#" id="linkToggleAllElements" onclick="ToggleAllElements('Hierarchy,Pascal,Description,Todo,See_Also,Related_Information', 'linkToggleAllElements', 'imgToggleAllElements', 'Collapse All', 'Expand All');">Collapse All</a></div>
</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="Summary"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Implements a SMTP Relay agent.</p></div>
</div>
<a name="File"></a><div class="Element14">
File</div>
<div class="Element10033">
<div class="Section33">
<p class="Section33">
<a href="IdSMTPRelay_pas.html" target="topic">IdSMTPRelay</a></p></div>
</div>
<a name="Hierarchy"></a><div class="Section1000032">
<a onclick="toggleVisibilityStored('Hierarchy');" class="a_Section1000032"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgHierarchy">Hierarchy</a></div>
<div id="divHierarchy">
<div class="Element151"><div class="Element150"><pre class="Element150"><img src="TIdSMTPRelay.png" border="0" alt="" title="" usemap="#TIdSMTPRelay"><map class="Element150" name="TIdSMTPRelay"><area class="Element150" shape="rect" coords="139,0,257,15" href="TIdInitializerComponent.html"><area class="Element150" shape="rect" coords="287,0,388,15" href="TIdBaseComponent.html"><area class="Element150" shape="rect" coords="418,0,499,15" href="TIdComponent.html"><area class="Element150" shape="rect" coords="657,0,765,15" href="TIdTCPClientCustom.html"><area class="Element150" shape="rect" coords="795,0,896,15" href="TIdExplicitTLSClient.html"><area class="Element150" shape="rect" coords="926,0,1019,15" href="TIdMessageClient.html"><area class="Element150" shape="rect" coords="1049,0,1128,15" href="TIdSMTPBase.html"><area class="Element150" shape="rect" coords="1158,0,1241,15" href="TIdSMTPRelay.html"><area class="Element150" shape="rect" coords="529,0,627,15" href="TIdTCPConnection.html"></map></pre></div></div>
</div>
<a name="Pascal"></a><div class="Element99">
<a onclick="toggleVisibilityStored('Pascal');"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgPascal">Pascal</a></div>
<div id="divPascal">
<div class="Element101"><div class="Element100"><pre class="Element100">TIdSMTPRelay = <strong>class</strong>(TIdSMTPBase);</pre></div></div>
</div>
<a name="Description"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Description');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgDescription">Description</a></div>
<div id="divDescription">
<div class="Element11">
<div class="Element10">
<p class="Element10">
TIdSMTPRelay is a <a href="TIdSMTPBase.html" target="topic">TIdSMTPBase</a> descendant that implements a SMTP Relay agent.&nbsp;</p>
<p class="Element10">
An important feature of SMTP is its capability to transport mail across networks, usually referred to as &quot;SMTP mail relaying&quot;. Using the SMTP protocol, a relay can transfer mail to another process on the same network or to some other network. With SMTP relay, a mail message may pass through a number of intermediate relay or gateway hosts on its path from sender to ultimate recipient. The Mail eXchanger mechanisms of the domain name system (DNS) are used to identify the appropriate next-hop destination for a message being transported. A &quot;relay&quot; SMTP system (usually referred to just as a &quot;relay&quot;) receives mail from an SMTP client and transmits it, without modification to the message data other than adding trace information, to another SMTP server for further relaying or for delivery.&nbsp;</p>
<p class="Element10">
When you attempt to <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">send</a> SMTP mail or use SMTP Relay features, you may receive an error message that your e-mail cannot be sent due to SMTP relay blocking.&nbsp;</p>
<p class="Element10">
The exact error message may vary, depending on your Internet Service Provider (ISP); however, it will be similar to the following error message:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00063');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00063"><pre class="Element12">The <strong>message</strong> could <strong>not</strong> be sent because one <strong>of</strong> the recipients was
rejected by the server.

The rejected e-mail address was '&lt;someone@somedomain.com&gt;'
Subject: '&lt;Test&gt;'
Account: '&lt;Test&gt;'
Server: '&lt;smtp.somedomain.com&gt;'
Protocol: SMTP
Server Response: '550 &lt;someone@somedomain.com&gt;... Relaying Denied'
Port: 25
Secure (SSL): No
Server Error: 550</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
This problem can occur when the ISP uses an Internet gateway and you are attempting to <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">send</a> e-mail through an Internet Service Provider's SMTP gateway. The condition may also occur when attempt to <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">send</a> e-mail through another Internet Service Provider's SMTP gateway. Another cause is when the reply address in the mail account properties is different than that of your Internet Service Provider.&nbsp;</p>
<p class="Element10">
This problem affects all messaging clients, regardless of manufacturer.&nbsp;</p>
<p class="Element10">
Customers should contact their ISP for assistance since this problem is not caused by the e-mail client. From a messaging client standpoint, there are no solutions for customers who have ISP's that block all SMTP Relay traffic.&nbsp;</p>
<p class="Element10">
Most of the new SMTP e-mail gateway software can allow relaying for specific IP addresses. This is how cable modem and ADSL users will be able to continue to use their same ISP. The cable modem or ADSL provider must provide the customer a static IP address, in turn, the customer's e-mail ISP will allow relaying for that specific IP address. Banks of IP addresses can also be allowed which may provide a workaround for some corporate customers who access ISP's through their corporate LAN.&nbsp;</p>
<p class="Element10">
If the error is random, it is possible that your SMTP server is checking whether the domain for the recipient name actually exists before sending. If the recipient's mail server is temporarily down or unavailable for another reason, such as high network volume, your SMTP server cannot verify the address and may reject the relay. In this case, no action is required. The message will be sent when the receiving server is again available.&nbsp;</p>
<p class="Element10">
This problem may become more common as ISP's begin to take action against SPAM e-mail. SPAM is flooding the Internet with many copies of the same message in an attempt to <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">send</a> the message to people who would not otherwise choose to receive it. Most SPAM uses an automated system to <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">send</a> commercial advertising, or mass marketing e-mail messages. SPAM costs the sender very little to <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">send</a>; most of the costs are paid for by the recipient or the e-mail providers.&nbsp;</p>
<p class="Element10">
Some ISP's are fighting SPAM by requiring each user to be dialed directly into their system in order to <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">send</a> e-mail through their SMTP gateway. This is an easy way to control SPAM but may affect some users who tunnel into their e-mail account from another ISP.&nbsp;</p>
<p class="Element10">
TIdSMTPRelay connects directly with the recipient's SMTP server and delivers the message. It does not use a relay SMTP server to deliver the message.&nbsp;</p>
<p class="Element10">
TIdSMTPRelay overrides the <a href="TIdExplicitTLSClient_Connect.html" target="topic">Connect</a> and <a href="TIdTCPConnection_Disconnect.html" target="topic">Disconnect</a> methods to provide support for dynamically resolving host names based on the MX server of the recipient's domain.&nbsp;</p>
<p class="Element10">
TIdSMTPRelay introduces the <a href="TIdSMTPRelay_StatusList.html" target="topic">StatusList</a> property containing the status of each recipients' address after the <a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">Send</a> method is called and the <a href="TIdSMTPRelay_OnDirectSMTPStatus.html" target="topic">OnDirectSMTPStatus</a> event handler to keep track of the status as the sending is in progress.</p></div>
</div>
</div>
<a name="Todo"></a><div class="Element14">
<a onclick="toggleVisibilityStored('Todo');" class="a_Element14"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgTodo">Todo</a></div>
<div id="divTodo">
<div class="Element11">
<div class="Element10">
<p class="Element10">
D.3 Relayed Mail Scenario&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element103"><div class="Element102"><pre class="Element102">   Step 1  --  Source Host to Relay Host

      S: 220 foo.com Simple Mail Transfer Service Ready
      C: EHLO bar.com
      S: 250-foo.com greets bar.com
      S: 250-8BITMIME
      S: 250-SIZE
      S: 250-DSN
      S: 250 HELP
      C: MAIL FROM:&lt;JQP@bar.com&gt;
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: RCPT TO:&lt;@foo.com:Jones@XYZ.COM&gt;
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: DATA
      S: 354 Start mail input; end with &lt;CRLF&gt;.&lt;CRLF&gt;
      C: Date: Thu, 21 May 1998 05:33:29 -0700
      C: From: John Q. Public &lt;JQP@bar.com&gt;
      C: Subject:  The Next Meeting of the Board
      C: To: Jones@xyz.com
      C:
      C: Bill:
      C: The next meeting of the board of directors will be
      C: on Tuesday.
      C:                         John.
      C: .
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: QUIT
      S: 221 foo.com Service closing transmission channel</pre></div></div>
<p class="Element10">
&nbsp;</p>
<div class="Element103"><div class="Element102"><pre class="Element102">   Step 2  --  Relay Host to Destination Host

      S: 220 xyz.com Simple Mail Transfer Service Ready
      C: EHLO foo.com
      S: 250 xyz.com is on the air
      C: MAIL FROM:&lt;@foo.com:JQP@bar.com&gt;
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: RCPT TO:&lt;Jones@XYZ.COM&gt;
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: DATA
      S: 354 Start mail input; end with &lt;CRLF&gt;.&lt;CRLF&gt;
      C: Received: from bar.com by foo.com ; Thu, 21 May 1998
      C:     05:33:29 -0700
      C: Date: Thu, 21 May 1998 05:33:22 -0700
      C: From: John Q. Public &lt;JQP@bar.com&gt;
      C: Subject:  The Next Meeting of the Board
      C: To: Jones@xyz.com
      C:
      C: Bill:
      C: The next meeting of the board of directors will be
      C: on Tuesday.
      C:                         John.
      C: .
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: QUIT
      S: 221 foo.com Service closing transmission channel</pre></div></div>
<p class="Element10">
&nbsp;</p>
<div class="Element103"><div class="Element102"><pre class="Element102">D.4 Verifying and Sending Scenario

      S: 220 foo.com Simple Mail Transfer Service Ready
      C: EHLO bar.com
      S: 250-foo.com greets bar.com
      S: 250-8BITMIME
      S: 250-SIZE
      S: 250-DSN
      S: 250-VRFY
      S: 250 HELP
      C: VRFY Crispin
      S: 250 Mark Crispin &lt;Admin.MRC@foo.com&gt;
      C: SEND FROM:&lt;EAK@bar.com&gt;
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: RCPT TO:&lt;Admin.MRC@foo.com&gt;
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: DATA
      S: 354 Start mail input; end with &lt;CRLF&gt;.&lt;CRLF&gt;
      C: Blah blah blah...
      C: ...etc. etc. etc.
      C: .
      S: 250 <a href="OK.html" target="topic">OK</a>
      C: QUIT
      S: 221 foo.com Service closing transmission channel</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
Discuss implementation details.&nbsp;</p>
<p class="Element10">

<ul class="Element631">
<li class="Element601"><a href="TIdExplicitTLSClient_Connect.html" target="topic">Connect</a></li>
<li class="Element601"><a href="TIdTCPConnection_Disconnect.html" target="topic">Disconnect</a></li>
<li class="Element601">Host</li>
<li class="Element601"><a href="TIdSMTPRelay_DNSServer.html" target="topic">DNSServer</a></li>
<li class="Element601"><a href="TIdSMTPRelay_Send@TIdMessage.html" target="topic">Send</a></li>
<li class="Element601">Resolving MX Servers</li>
<li class="Element601"><a href="TIdSMTPRelay_StatusList.html" target="topic">StatusList</a> and StatusItems</li>
<li class="Element601"><a href="TIdSMTPRelay_OnDirectSMTPStatus.html" target="topic">OnDirectSMTPStatus</a></li>
</ul>&nbsp;</p>
<p class="Element10">
Discuss TLS and SSL.&nbsp;</p>
<p class="Element10">
Discuss authentication methods and requirements.</p></div>
</div>
</div>
<a name="See_Also"></a><div class="Section1000009">
<a onclick="toggleVisibilityStored('See_Also');" class="a_Section1000009"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgSee_Also">See Also</a></div>
<div id="divSee_Also">
<div class="Element10009">
<div class="Section9">
<p class="Section9">
<a href="TIdSMTPBase.html" target="topic">TIdSMTPBase</a></p></div>
</div>
</div>
<a name="Related_Information"></a><div class="Section1000034">
<a onclick="toggleVisibilityStored('Related_Information');" class="a_Section1000034"><img src="btn_collapse_large.gif" border="0" alt="" title="" id="imgRelated_Information">Related Information</a></div>
<div id="divRelated_Information">
<div class="Element10034">
<div class="Section34">
<a href="!!MEMBERTYPE_Methods_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Methods</a><br /><a href="!!MEMBERTYPE_Properties_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Properties</a><br /><a href="!!MEMBERTYPE_Events_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Events</a><br /><a href="!!MEMBEROVERVIEW_TIdSMTPRelay.html" target="topic">TIdSMTPRelay Members</a></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
Copyright © 1993-2006, Chad Z. Hower (aka Kudzu) and the Indy Pit Crew. All rights reserved.</div>
</td></tr><tr><td width="100%">
<div class="Element97">
Post feedback to the <a href="news://news.atozed.com/atozedsoftware.indy.documentation">Indy Docs Newsgroup</a>.</div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>